# 语音对话功能测试指南

## 测试环境准备

### 1. 安装扩展
1. 打开Chrome浏览器
2. 进入 `chrome://extensions/`
3. 开启"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择项目的 `dist` 文件夹

### 2. 权限设置
1. 确保扩展有麦克风权限
2. 在浏览器设置中允许网站访问麦克风
3. 确保系统音量和麦克风音量适中

## 功能测试清单

### ✅ 基础设置测试

#### 1. 语音对话设置界面
- [ ] 打开扩展popup
- [ ] 找到"🎙️ 语音对话设置"部分
- [ ] 验证所有设置选项都正常显示
- [ ] 测试开关按钮功能

#### 2. 语音录入设置
- [ ] 启用语音录入开关
- [ ] 选择识别语言（中文简体）
- [ ] 调节灵敏度滑块（建议70%）
- [ ] 点击"🎤 测试语音录入"按钮
- [ ] 说话测试，验证识别结果

#### 3. 语音播放设置
- [ ] 启用语音播放开关
- [ ] 调节播放速度（建议1.0x）
- [ ] 调节播放音量（建议80%）
- [ ] 选择"使用TTS引擎"（如果已配置）
- [ ] 点击"🔊 测试语音播放"按钮
- [ ] 验证能听到测试语音

### ✅ 虚拟角色对话测试

#### 1. 打开角色对话
- [ ] 在任意网页上找到虚拟角色
- [ ] 点击角色打开对话界面
- [ ] 验证对话界面正常显示

#### 2. 基础语音输入测试
- [ ] 点击对话界面中的🎤按钮
- [ ] 验证按钮变红，显示"正在监听..."
- [ ] 说出测试语句："你好，请介绍一下自己"
- [ ] 验证语音被正确识别并转换为文字
- [ ] 点击发送或等待自动发送

#### 3. 语音播放测试
- [ ] 发送消息后等待角色回复
- [ ] 如果启用了自动播放，验证回复会自动语音播放
- [ ] 测试播放过程中的停止功能
- [ ] 验证播放完成后状态正常

#### 4. 连续对话模式测试
- [ ] 在对话界面中找到"连续语音对话"设置
- [ ] 点击"开始对话"按钮
- [ ] 验证界面显示"💬 对话模式"状态
- [ ] 说出第一句话，等待角色回复
- [ ] 验证角色回复完成后自动开始下一轮监听
- [ ] 继续对话2-3轮测试连续性
- [ ] 点击"结束对话"或⏹️按钮停止

### ✅ 高级功能测试

#### 1. 语音状态指示器
- [ ] 验证"🎤 正在监听..."状态显示
- [ ] 验证"🔊 正在播放..."状态显示
- [ ] 验证"💬 对话模式"状态显示
- [ ] 测试⏹️停止按钮功能

#### 2. 错误处理测试
- [ ] 在无麦克风权限时测试语音输入
- [ ] 在网络断开时测试语音功能
- [ ] 测试语音识别失败的处理
- [ ] 测试语音播放失败的处理

#### 3. 设置同步测试
- [ ] 修改语音设置后测试是否立即生效
- [ ] 在不同标签页中测试设置一致性
- [ ] 重启浏览器后验证设置保持

### ✅ 性能和体验测试

#### 1. 响应速度
- [ ] 测试语音识别的响应速度
- [ ] 测试语音播放的启动速度
- [ ] 测试对话模式切换的流畅性

#### 2. 音质测试
- [ ] 测试不同播放速度下的音质
- [ ] 测试不同音量下的清晰度
- [ ] 比较TTS和Web Speech API的音质差异

#### 3. 稳定性测试
- [ ] 连续使用30分钟测试稳定性
- [ ] 快速切换语音功能测试
- [ ] 多标签页同时使用测试

## 常见问题排查

### 问题1：无法进行语音识别
**可能原因：**
- 麦克风权限未授予
- 浏览器不支持Web Speech API
- 麦克风被其他应用占用

**解决方案：**
1. 检查浏览器麦克风权限设置
2. 尝试刷新页面重新授权
3. 关闭其他使用麦克风的应用

### 问题2：语音播放无声音
**可能原因：**
- 系统音量过低
- TTS配置错误
- 浏览器音频被禁用

**解决方案：**
1. 检查系统音量设置
2. 切换到Web Speech API模式
3. 检查浏览器音频权限

### 问题3：连续对话模式异常
**可能原因：**
- 网络连接不稳定
- 语音识别超时
- 配置参数不当

**解决方案：**
1. 检查网络连接
2. 调整语音识别灵敏度
3. 重新启动对话模式

## 测试报告模板

### 测试环境
- 浏览器版本：Chrome xxx
- 操作系统：macOS/Windows/Linux
- 测试时间：YYYY-MM-DD
- 扩展版本：v1.2.0

### 测试结果
- [ ] 基础设置功能：✅ 通过 / ❌ 失败
- [ ] 语音录入功能：✅ 通过 / ❌ 失败
- [ ] 语音播放功能：✅ 通过 / ❌ 失败
- [ ] 连续对话功能：✅ 通过 / ❌ 失败
- [ ] 错误处理机制：✅ 通过 / ❌ 失败

### 发现的问题
1. 问题描述：
   - 重现步骤：
   - 预期结果：
   - 实际结果：

### 改进建议
1. 功能改进：
2. 性能优化：
3. 用户体验：

---

完成测试后，请将结果反馈给开发团队，以便持续改进语音对话功能。
