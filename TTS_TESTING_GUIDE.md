# TTS语音通知功能测试指南

## 安装和配置

### 1. 安装Chrome插件
1. 打开Chrome浏览器
2. 进入 `chrome://extensions/`
3. 开启"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择项目的 `dist` 文件夹

### 2. 获取字节跳动TTS API密钥
1. 访问 [字节跳动语音开放平台](https://openspeech.bytedance.com/)
2. 注册账号并登录
3. 创建新应用
4. 获取以下信息：
   - AppID（应用ID）
   - Access Token（访问令牌）

### 3. 配置TTS服务
1. 点击Chrome工具栏中的插件图标
2. 在弹出的popup页面中找到"语音合成设置"部分
3. 开启"启用语音通知"开关
4. 输入获取的AppID和Token
5. 选择喜欢的语音类型
6. 调节语速（可选）
7. 点击"测试语音合成"按钮验证配置

## 功能测试

### 测试1：TTS配置验证
**目标：** 验证TTS服务配置是否正确

**步骤：**
1. 在TTS设置中输入正确的API密钥
2. 点击"测试语音合成"按钮
3. 应该听到"这是语音合成测试，你好！"的语音播放

**预期结果：**
- ✅ 显示"测试成功！语音合成正常工作。"
- ❌ 如果配置错误，显示具体错误信息

### 测试2：专注模式启动语音提醒
**目标：** 验证专注模式启动时的语音通知

**步骤：**
1. 确保TTS已正确配置并启用
2. 设置专注时间（如25分钟）
3. 点击"开始专注"按钮

**预期结果：**
- 听到类似"专注模式已启动，专注时间：25分钟。加油，保持专注！"的语音播放
- 如果TTS失败，应该回退到普通音效

### 测试3：专注模式结束语音提醒
**目标：** 验证专注时间结束时的个性化语音通知

**步骤：**
1. 启动专注模式（建议设置较短时间如1分钟进行测试）
2. 等待专注时间结束
3. 观察是否播放语音通知

**预期结果：**
- 听到AI生成的个性化休息提醒语音
- 如果启用了AI通知，内容应该更加个性化和鼓励性
- 如果TTS失败，应该回退到普通音效

### 测试4：回退机制验证
**目标：** 验证TTS失败时的回退机制

**步骤：**
1. 故意输入错误的API密钥或禁用网络
2. 启动专注模式
3. 观察音频播放行为

**预期结果：**
- 应该播放普通的notification.mp3音效
- 不应该出现错误或静音

### 测试5：不同语音类型测试
**目标：** 验证不同语音类型的效果

**步骤：**
1. 在TTS设置中选择不同的语音类型
2. 分别测试男声和女声
3. 测试不同的语速设置

**预期结果：**
- 不同语音类型应该有明显的声音差异
- 语速调节应该生效

## 故障排除

### 常见问题1：测试语音合成失败
**可能原因：**
- API密钥错误
- 网络连接问题
- 字节跳动服务暂时不可用

**解决方案：**
1. 检查API密钥是否正确
2. 确认网络连接正常
3. 查看浏览器控制台错误信息

### 常见问题2：专注模式没有语音提醒
**可能原因：**
- TTS未启用
- 声音设置被禁用
- 浏览器音频权限问题

**解决方案：**
1. 确认TTS开关已启用
2. 检查声音设置中的"启用通知声音"
3. 确认浏览器允许音频播放

### 常见问题3：语音播放中断或不完整
**可能原因：**
- 网络不稳定
- 音频文件损坏
- 浏览器资源限制

**解决方案：**
1. 检查网络连接稳定性
2. 重新测试TTS配置
3. 重启浏览器

## 调试信息

### 查看控制台日志
1. 打开Chrome开发者工具（F12）
2. 切换到"Console"标签
3. 查看相关日志信息：
   - `TTS generation successful` - TTS生成成功
   - `TTS sound played successfully` - TTS播放成功
   - `TTS generation failed` - TTS生成失败

### 检查存储数据
1. 在开发者工具中切换到"Application"标签
2. 展开"Storage" > "Local Storage"
3. 查看TTS配置数据

## 性能监控

### 音频资源清理
- 检查是否有内存泄漏
- 确认临时音频URL被正确清理
- 监控浏览器内存使用情况

### API调用频率
- 避免频繁测试以免超出API限制
- 监控API响应时间
- 记录失败率和成功率

## 反馈和改进

如果在测试过程中发现问题，请记录：
1. 具体的错误信息
2. 复现步骤
3. 浏览器版本和操作系统
4. 网络环境信息

这些信息将有助于进一步优化和改进TTS语音通知功能。
